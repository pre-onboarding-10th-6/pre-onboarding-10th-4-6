# 1. í”„ë¡œì íŠ¸

ì›í‹°ë“œ í”„ë¡ íŠ¸ì—”ë“œ ì¸í„´ì‹­ 4ì£¼ì°¨ ê³¼ì œ <br>
êµ¬í˜„ ëª©í‘œ: ê¸°ì¡´ ì½”ë“œ ë¦¬í™í† ë§ ë° ì¶”ì²œ ê¸°ëŠ¥ êµ¬í˜„, ë¬¸ì„œí™”

ë°°í¬ë§í¬: https://pre-onboarding-10th-4-6.vercel.app/

## íŒ€ì›ëª©ë¡

- íŒ€ì¥ : ì´ì •ì§„
- íŒ€ì› : ê³½í˜„ì§€, ê¹€ì„±ì£¼, ë°•ì¬ìš±, ì‹ ì¢…ìš°, ì–‘ì£¼ì˜, ì´ì›í˜•, ì •ë‹¤ì†”, ì •ì˜ˆì§€


| &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;íŒ€6&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ì´ì •ì§„&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ê³½í˜„ì§€&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | ê¹€ì„±ì£¼ | ë°•ì¬ìš± |
| :---: | :---: | :---: | :---: | :---: |
| ì—­í•  | ![Leader](https://img.shields.io/badge/-%ED%8C%80%EC%9E%A5-blue) | ![íŒ€ì›](https://img.shields.io/badge/-%ED%8C%80%EC%9B%90-yellow) | ![íŒ€ì›](https://img.shields.io/badge/-%ED%8C%80%EC%9B%90-yellow) | ![íŒ€ì›](https://img.shields.io/badge/-%ED%8C%80%EC%9B%90-yellow) | ![íŒ€ì›](https://img.shields.io/badge/-%ED%8C%80%EC%9B%90-yellow) |
| Github | [wjdrk70](https://github.com/wjdrk70) | [hjKwak](https://github.com/KwakHyeonJi) | [dev-seongjoo](https://github.com/dev-seongjoo) | [LeChuckbb](https://github.com/LeChuckbb) | [jw3215](https://github.com/jw3215) 

| &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ì‹ ì¢…ìš°&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ì–‘ì£¼ì˜&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | ì´ì›í˜• | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ì •ë‹¤ì†”&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; | &nbsp;&nbsp;&nbsp;&nbsp;&nbsp;ì •ì˜ˆì§€&nbsp;&nbsp;&nbsp;&nbsp;&nbsp; |
| :---: | :---: | :---: | :---: | :---: |
| ![íŒ€ì›](https://img.shields.io/badge/-%ED%8C%80%EC%9B%90-yellow) | ![íŒ€ì›](https://img.shields.io/badge/-%ED%8C%80%EC%9B%90-yellow) | ![íŒ€ì›](https://img.shields.io/badge/-%ED%8C%80%EC%9B%90-yellow) | ![íŒ€ì›](https://img.shields.io/badge/-%ED%8C%80%EC%9B%90-yellow) | ![íŒ€ì›](https://img.shields.io/badge/-%ED%8C%80%EC%9B%90-yellow)
 | [jw3215](https://github.com/jw3215) | [yangddu](https://github.com/yangddu) | [WonhyeongLee](https://github.com/WonhyeongLee) | [ssori0421](https://github.com/ssori0421) | [sabit1997](https://github.com/sabit1997) |

<br />

<br />

# 2. í˜‘ì—… ë°©ì‹

- ê°ì ê¸°ëŠ¥ êµ¬í˜„ í›„ ì½”ë“œ ë°œí‘œ ì§„í–‰
- ë°œí‘œ í›„, ê°ì ì½”ë“œ ë¦¬ë·°í•˜ë©° ì½”ë“œ ë² ì´ìŠ¤ ì„ ì •
- ì„ ì •ëœ ì½”ë“œ ë² ì´ìŠ¤ì—ì„œ ê° íŒ€ì›ì˜ ì¢‹ì€ ì½”ë“œë¥¼ ì·¨í•©í•´ì„œ ì‘ì„±
- ë¹„ì¦ˆë‹ˆìŠ¤ ë¡œì§ ë° view ë¥¼ ê°œì„ í•˜ì—¬ PR ì§„í–‰ í›„ merge

[git commit message ê·œì¹™ ì„¤ì •]

- ì¼ê´€ëœ ì»¤ë°‹ ë©”ì‹œì§€ì˜ í˜•íƒœë¡œ ê°€ë…ì„±ì„ ë†’ì´ê³ , íŒ€ì›ë“¤ì˜ ì‘ì—… ë‚´ì—­ ë° ë³€ê²½ì‚¬í•­ ì‰½ê²Œ íŒŒì•… ê°€ëŠ¥

<br />

# 3. ë””ë ‰í† ë¦¬ êµ¬ì¡°

```
ğŸ“¦
â”œâ”€ src
â”‚  â”œâ”€ axiosClient
â”‚  â”œâ”€ components
â”‚  â”œâ”€ context
â”‚  â”œâ”€ error
â”‚  â”œâ”€ hooks
â”‚  â”œâ”€ pages
â”‚  â””â”€ service
```

<br />

# 3. êµ¬í˜„ ë‚´ìš©

### 1) Dropdown ì¶”ì²œ ê²€ìƒ‰ì–´ í‘œì‹œ

`Dropdown` ì»´í¬ë„ŒíŠ¸ëŠ” ê²€ìƒ‰ì–´ë¥¼ ì…ë ¥í•˜ë©´ ì…ë ¥í•œ í…ìŠ¤íŠ¸ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ì¶”ì²œ ê²€ìƒ‰ì–´ ëª©ë¡ì„ ì œê³µí•œë‹¤.

`useEffect` í›…ì€ `keyword`ì˜ ë³€ê²½ì„ ê°ì§€í•˜ê³  `keyword`ê°€ ë³€ê²½ë˜ë©´, ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì´ˆê¸°í™”í•˜ê³  ìƒˆë¡œìš´ ê²€ìƒ‰ì–´ë¥¼ ê¸°ë°˜ìœ¼ë¡œ ê²€ìƒ‰ì„ ì‹œì‘í•œë‹¤. `addResults` í•¨ìˆ˜ëŠ” ì£¼ì–´ì§„ ê²€ìƒ‰ì–´ë¥¼ ì´ìš©í•˜ì—¬ ê²€ìƒ‰ ì‘ì—…ì„ ìˆ˜í–‰í•˜ê³  ê²°ê³¼ë¥¼ ìƒíƒœì— ì¶”ê°€í•œë‹¤. ìµœì¢…ì ìœ¼ë¡œ `useSearchState`ì— ì €ì¥ëœ ì¶”ì²œ ê²€ìƒ‰ì–´ ëª©ë¡ì„ ê°€ì ¸ì™€ì„œ `Dropdown` ì»´í¬ë„ŒíŠ¸ì— ë Œë”ë§ì´ ì´ë£¨ì–´ì§„ë‹¤.

```tsx
const Dropdown = ({
  keyword,
  isSearching,
  resetInput,
  changeStatus,
  isDropdownVisible
}: DropdownProps) => {
  const { results, isEnd } = useSearchState()
  const { add: addResults, reset } = useSearchDispatch()

  ...

  useEffect(() => {
    const fetch = async () => {
      changeStatus(StatusTypes.SEARCHING)
      await addResults(keyword)
      changeStatus(StatusTypes.IDLE)
    }

    reset()
    keyword && fetch()
  }, [keyword])

  return isDropdownVisible && results.length ? (
    <DropdownLayout ref={infiniteScrollRef}>
      {results.map(result => (
        <DropdownItem key={result} onClick={() => handleAddTodo(result)}>
          {keyword.length ? (
            <ColoredKeyword text={result} keyword={keyword} />
          ) : (
            result
          )}
        </DropdownItem>
      ))}
      <DropdownOption>
        {isSearching ? <Spinner /> : !isEnd && <FaEllipsisH />}
      </DropdownOption>
    </DropdownLayout>
  ) : (
    <></>
  )
}
```

<br />

### 2) ê²€ìƒ‰ API í˜¸ì¶œ Debounce ì ìš©

`useDebounce` í›…ì€ ê²€ìƒ‰ì–´(keyword)ë¥¼ ì…ë ¥ë°›ì•„ í•´ë‹¹ ê²€ìƒ‰ì–´ë¥¼ delay ì‹œê°„ë™ì•ˆ ê¸°ë‹¤ë¦° í›„, ê·¸ ê²€ìƒ‰ì–´ë¥¼ `debouncedValue`ì— ì €ì¥í•˜ì—¬ ë°˜í™˜í•œë‹¤.

ì´ë ‡ê²Œ `debouncedValue`ì„ ì‚¬ìš©í•˜ë©´ ì‚¬ìš©ìê°€ ê²€ìƒ‰ì–´ë¥¼ ê³„ì†í•´ì„œ ì…ë ¥í•  ë•Œë§ˆë‹¤ API ìš”ì²­ì„ ë³´ë‚´ì§€ ì•Šê³ , ì¼ì • ì‹œê°„ ë™ì•ˆ ê²€ìƒ‰ì–´ ì…ë ¥ì´ ë©ˆì¶˜ ë’¤ì— API ìš”ì²­ì„ ë³´ë‚´ê²Œ ëœë‹¤. ì´ë ‡ê²Œ í•¨ìœ¼ë¡œì¨ API í˜¸ì¶œ íšŸìˆ˜ë¥¼ ì œí•œí•  ìˆ˜ ìˆë‹¤.

`useDebounce` í›…ì€ `useState`ì™€ `useEffect`ë¥¼ ì‚¬ìš©í•˜ì—¬, valueì™€ delayê°€ ë°”ë€” ë•Œë§ˆë‹¤ íƒ€ì´ë¨¸ë¥¼ ì´ˆê¸°í™”í•˜ê³ , delay ì‹œê°„ì´ ì§€ë‚œ í›„ì— valueë¥¼ `debouncedValue`ì— ì €ì¥í•˜ì—¬ ë°˜í™˜í•œë‹¤.

```ts
import { useState, useEffect } from 'react'

const useDebounce = <T>(value: T, delay: number) => {
  const [debouncedValue, setDebouncedValue] = useState(value)

  useEffect(() => {
    const timer = setTimeout(() => {
      setDebouncedValue(value)
    }, delay)

    return () => {
      clearTimeout(timer)
    }
  }, [value, delay])

  return debouncedValue
}

export default useDebounce
```

```ts
const debouncedValue = useDebounce(value, DEBOUNCE_DELAY)
```

<br />

### 3) Infinite scroll

`useInfiniteScroll` ì»¤ìŠ¤í…€ í›…ì„ ì‚¬ìš©í•˜ì—¬ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ë¥¼ ê°ì§€í•˜ì—¬ í•„ìš”í•œ ë™ì‘ì„ ìˆ˜í–‰í•˜ê³ , ìŠ¤í¬ë¡¤ ê°€ëŠ¥ ì—¬ë¶€ë¥¼ ì œì–´í•˜ì—¬ ì ì ˆí•œ ì‹œì ì— ë°ì´í„°ë¥¼ ë” ë¶ˆëŸ¬ì˜¤ê±°ë‚˜ ì²˜ë¦¬í•œë‹¤.

í›… ë‚´ë¶€ì—ì„œëŠ” `containerRef.current`ë¥¼ ì‚¬ìš©í•˜ì—¬ ì»¨í…Œì´ë„ˆ ì—˜ë¦¬ë¨¼íŠ¸ë¥¼ ì°¸ì¡°í•œë‹¤. `handleScroll` ì½œë°± í•¨ìˆ˜ëŠ” í˜„ì¬ ìŠ¤í¬ë¡¤ ìœ„ì¹˜ì™€ ì»¨í…Œì´ë„ˆì˜ ë†’ì´, ìŠ¤í¬ë¡¤ ê°€ëŠ¥ ì—¬ë¶€ë¥¼ í™•ì¸í•˜ì—¬ ìŠ¤í¬ë¡¤ì´ í˜ì´ì§€ í•˜ë‹¨ì— ë„ë‹¬í–ˆì„ ë•Œ `onScrollEnd`ë¥¼ í˜¸ì¶œí•˜ê³  `canScroll` ìƒíƒœë¥¼ `false`ë¡œ ì„¤ì •í•œë‹¤.

`containerRef.current`ê°€ ì¡´ì¬í•˜ëŠ” ê²½ìš°ì—ëŠ” ì»¨í…Œì´ë„ˆ ì—˜ë¦¬ë¨¼íŠ¸ì˜ scroll ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ì¶”ê°€í•˜ê³ , ì»´í¬ë„ŒíŠ¸ê°€ ì–¸ë§ˆìš´íŠ¸ë˜ê±°ë‚˜ ì»¨í…Œì´ë„ˆ ì—˜ë¦¬ë¨¼íŠ¸ê°€ ë³€ê²½ë  ë•Œ ì´ë²¤íŠ¸ ë¦¬ìŠ¤ë„ˆë¥¼ ì œê±°í•˜ëŠ” í´ë¦°ì—… í•¨ìˆ˜ë¥¼ ë°˜í™˜í•œë‹¤.

ë§ˆì§€ë§‰ìœ¼ë¡œ, containerRefë¥¼ ë°˜í™˜í•˜ì—¬ ì»´í¬ë„ŒíŠ¸ì—ì„œ ì»¨í…Œì´ë„ˆ ì—˜ë¦¬ë¨¼íŠ¸ì— Refë¥¼ ì ìš©í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.

> #### Debug
>
> - `scrollTop` ê³¼ `clientHeight`ì„ ë”í•œ ê°’ì´ `scrollHeight` ë³´ë‹¤ ê°™ê±°ë‚˜ í° ê²½ìš° ìŠ¤í¬ë¡¤ì„ ëê¹Œì§€ í•œ ê²ƒìœ¼ë¡œ íŒë³„í•˜ê³ , API fetching í›„, ì„ ì¶”ê°€
> - íŠ¹ì • í•´ìƒë„ ë° í™”ë©´ ë°°ìœ¨ì—ì„œëŠ” ì¶”ê°€ë¡œ API fetchingì„ í•˜ì§€ ëª»í•˜ëŠ” ê²ƒì„ í™•ì¸
> - ì†Œìˆ˜ì  ì˜¤ì°¨ë¡œ ì¸í•œ ë²„ê·¸ (ex. 99.99999 + 100 >= 200)
> - `Math.ceil()`ë¡œ ì†Œìˆ˜ì  ì˜¬ë¦¼í•˜ì—¬ ë²„ê·¸ ìˆ˜ì •

```ts
const useInfiniteScroll = <T extends HTMLElement>(
  onScrollEnd: () => void,
  length: number
) => {
  const [canScroll, setCanScroll] = useState(true)
  const containerRef = useRef<T | null>(null)

  useEffect(() => {
    const container = containerRef.current

    const handleScroll = () => {
      if (!container) {
        return
      }

      const { scrollHeight, scrollTop, clientHeight } = container
      if (canScroll && Math.ceil(scrollTop + clientHeight) >= scrollHeight) {
        onScrollEnd()
        setCanScroll(false)
      }
    }

    if (container) {
      container.addEventListener('scroll', handleScroll)

      return () => {
        if (container) {
          container.removeEventListener('scroll', handleScroll)
        }
      }
    }
  }, [canScroll, onScrollEnd])

  useEffect(() => {
    setCanScroll(true)
  }, [length])

  return containerRef
}
```

```tsx
  const infiniteScrollRef = useInfiniteScroll<HTMLUListElement>(
    addMore,
    results.length
  )

  ...

  return isDropdownVisible && results.length ? (
    <DropdownLayout ref={infiniteScrollRef}>
      {results.map(result => (
        <DropdownItem key={result} onClick={() => handleAddTodo(result)}>
          {keyword.length ? (
            <ColoredKeyword text={result} keyword={keyword} />
          ) : (
            result
          )}
        </DropdownItem>
      ))}
      <DropdownOption>
        {isSearching ? <Spinner /> : !isEnd && <FaEllipsisH />}
      </DropdownOption>
    </DropdownLayout>
  ) : (
    <></>
  )
```

<br />

### 4) ê²€ìƒ‰ì–´ í•˜ì´ë¼ì´íŠ¸

`ColoredKeyword` ì»´í¬ë„ŒíŠ¸ëŠ” ì „ì²´ í…ìŠ¤íŠ¸(`text`)ì™€ ê²€ìƒ‰ì–´(`keyword`)ë¥¼ ë°›ì•„ì„œ ê²€ìƒ‰ì–´ ë¶€ë¶„ì´ í•˜ì´ë¼ì´íŠ¸ëœ í…ìŠ¤íŠ¸ ë¬¸ìì—´ì„ ë Œë”ë§í•œë‹¤.

ë¨¼ì €, `RegExp` ê°ì²´ë¥¼ ìƒì„±í•˜ì—¬ ê²€ìƒ‰ì–´ì— ëŒ€í•œ ì •ê·œ í‘œí˜„ì‹ì„ ë§Œë“ ë‹¤.

ë‹¤ìŒìœ¼ë¡œ, ê²€ìƒ‰ì–´ë¥¼ ê¸°ì¤€ìœ¼ë¡œ í…ìŠ¤íŠ¸ë¥¼ ë¶„í• í•˜ê³ , ì´ ê²°ê³¼ë¥¼ `words` ë°°ì—´ì— ì €ì¥í•œë‹¤. `exec` ë©”ì†Œë“œëŠ” ë§¤ì¹­ë˜ëŠ” í…ìŠ¤íŠ¸ì™€ ê·¸ ì¸ë±ìŠ¤ ì •ë³´ë¥¼ ì œê³µí•˜ë¯€ë¡œ, ì´ë¥¼ ì´ìš©í•´ ì›ë³¸ í…ìŠ¤íŠ¸ì—ì„œ ê²€ìƒ‰ì–´ ë¶€ë¶„ì„ ë”°ë¡œ ì¶”ì¶œí•˜ê³  `origins` ë°°ì—´ì— ì €ì¥í•œë‹¤.

ë§ˆì§€ë§‰ìœ¼ë¡œ, `words` ë°°ì—´ì„ ìˆœíšŒí•˜ë©´ì„œ ê° ë‹¨ì–´ë¥¼ ë Œë”ë§í•œë‹¤. ì´ë•Œ `split`í•œ ê²°ê³¼ ë°°ì—´ì˜ ì²« ë²ˆì§¸ ì›ì†ŒëŠ” ë¹ˆ ë¬¸ìì—´ì´ê±°ë‚˜, `keyword`ê°€ ì•„ë‹Œ ë¬¸ìì—´ì´ê¸° ë•Œë¬¸ì—, ì²«ë²ˆì§¸ ë‹¨ì–´ê°€ ì•„ë‹ˆë¼ë©´ `origins` ë°°ì—´ì—ì„œ í•´ë‹¹ ê²€ìƒ‰ì–´ë¥¼ ê°€ì ¸ì™€ ìƒ‰ìƒì„ ì…íŒ `Keyword` ì»´í¬ë„ŒíŠ¸ë¡œ í‘œì‹œí•˜ê³ , ê·¸ ë’¤ì— ë¶„ë¦¬ëœ ë‹¨ì–´ë¥¼ ë¶™ì¸ë‹¤.

```tsx
const ColoredKeyword = ({ text, keyword }: ColoredKeywordProps) => {
  const regex = new RegExp(keyword, 'gi')
  const words = text.split(regex)
  const origins: string[] = []

  let match
  while ((match = regex.exec(text)) !== null) {
    origins.push(match[0])
    text = text.slice(match.index + keyword.length)
  }

  return (
    <>
      {words.map((word, index) =>
        index > 0 ? (
          <span key={word + index}>
            <Keyword>{origins[index - 1]}</Keyword>
            {word}
          </span>
        ) : (
          <span key={word + index}>{word}</span>
        )
      )}
    </>
  )
}

const Keyword = styled.span`
  color: #2bc9ba;
`
```

<br />

### 5) Dropdownì—ì„œ ì•„ì´í…œ ì„ íƒ ì‹œ input ì´ˆê¸°í™” í›„ Todoì— ì¶”ê°€

Dropdown ì»´í¬ë„ŒíŠ¸ì—ì„œ í´ë¦­ í•˜ë©´ addTodo í˜¸ì¶œí•˜ë„ë¡ handleAddTodo í•¨ìˆ˜ë¥¼ êµ¬í˜„í•´ ì‚¬ìš©

```ts
// Dropdown.tsx
const handleAddTodo = async (title: string) => {
  try {
    changeStatus(StatusTypes.SAVING)
    await addTodo({ title })
    resetInput()
  } catch (error) {
    console.error(error)
    alert('Something went wrong.')
  } finally {
    changeStatus(StatusTypes.IDLE)
  }
}
```

list ë‚´ì˜ ì•„ì´í…œì„ í´ë¦­ ì‹œ handleAddTodoë¥¼ í•´ë‹¹ ì•„ì´í…œì˜ ê°’ì„ ì¸ìë¡œ í˜¸ì¶œ

```tsx
{
  results.map(result => (
    <DropdownItem key={result} onClick={() => handleAddTodo(result)}>
      <ColoredKeyword text={result} keyword={keyword} />
    </DropdownItem>
  ))
}
```

ì¶”ê°€ë¡œ ìš”êµ¬ì‚¬í•­ ëŒ€ë¡œ ì•„ì´í…œì„ click ì‹œ ìƒ‰ìƒì´ ë³€í•˜ë„ë¡ êµ¬í˜„

```css
const DropdownItem = styled.li`
  ...

  &:active {
    background: #d5f4f1;
  }
`
```

<br />

### 6) ê´€ì‹¬ì‚¬ì˜ ë¶„ë¦¬

api í˜¸ì¶œ ê´€ë ¨ ë¡œì§ë“¤ì„ Class ë‹¨ìœ„ë¡œ ë¶„ë¦¬í•˜ì—¬ ëª¨ë“ˆí™”

```ts
class AxiosClient {
  constructor(baseURL: string, token: string) {...}
  get(url: string, config?: AxiosRequestConfig) {...}
  delete(url: string, config?: AxiosRequestConfig) {...}
  post(url: string, data: unknown, config?: AxiosRequestConfig) {...}
}
```

```ts
class TodoService {
  constructor(apiRequest: AxiosClient) {...}
  async get() {...}
  async create(todo: { title: string }) {...}
  async delete(id: string) {...}
}
```

```ts
class SearchService {
  constructor(apiRequest: AxiosClient) {...}
  async get(q: string, page = 1, limit = 10) {...}
}
```

ì˜ì¡´ì„± ì£¼ì…

```ts
const axiosClient = new AxiosClient(
  process.env.REACT_APP_API_URL || '',
  process.env.REACT_APP_TOKEN || ''
)
const todoService = new TodoService(axiosClient)
const searchService = new SearchService(axiosClient)
```

<br />

### 7) ContextAPIë¡œ state ê³µìœ 

```ts
interface Todo {
  id: string
  title: string
}

type TodoState = Todo[]
```

```ts
type SearchState = { results: string[]; isEnd: boolean }
// results: dropdownì— í‘œì‹œë  ê²€ìƒ‰ ê²°ê³¼ ë¦¬ìŠ¤íŠ¸
// isEnd: apiì—ì„œ ë°›ì•„ì˜¬ ìˆ˜ ìˆëŠ” ëª¨ë“  ê²€ìƒ‰ ê²°ê³¼ë¥¼ ì €ì¥í–ˆëŠ”ì§€ ì²´í¬
```

```tsx
// index.tsx
...
<TodoProvider todoService={todoService}>
  <SearchProvider searchService={searchService}>
    <App />
  </SearchProvider>
</TodoProvider>
...
```

<br />

### 8) Error Boundaryë¥¼ ì´ìš©í•œ ì—ëŸ¬ ì²˜ë¦¬

ì»´í¬ë„ŒíŠ¸ íŠ¸ë¦¬ ìƒë‹¨ì— `ApiErrorBoundary` ì»´í¬ë„ŒíŠ¸ë¥¼ ë‘ì–´ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ì—ì„œ throwëœ ëª¨ë“  ì—ëŸ¬ë¥¼ catchí•œë‹¤. ì—ëŸ¬ì²˜ë¦¬ëŠ” ì—ëŸ¬ ìƒí™©ì— ë§ëŠ” í˜ì´ì§€ë¥¼ í™”ë©´ì— ë³´ì—¬ì£¼ëŠ” ë°©ì‹ìœ¼ë¡œ êµ¬í˜„í•˜ì˜€ë‹¤.

ëª¨ë“  API í˜¸ì¶œë¶€ë¥¼ `useTryCatchError` í›…ìœ¼ë¡œ ê°ì‹¸ì„œ API í˜¸ì¶œ ì‹œ ë°œìƒí•œ ì—ëŸ¬ê°€ `ApiErrorBoundary`ë¡œ ì „íŒŒë  ìˆ˜ ìˆë„ë¡ throwí•œë‹¤.
`getDerivedStateFromError` ì— HttpError ê°€ ë“¤ì–´ì˜¤ë©´ `hasError` ì™€ `statusCode` ë¥¼ ë°˜í™˜í•˜ì—¬ `401`,`404`,`500` ìœ¼ë¡œ ë¶„ê¸°í•´ì„œ ë°˜í™”í•˜ì—¬ ì—ëŸ¬í˜ì´ì§€ë¥¼ ë³´ì—¬ì¤€ë‹¤.

```tsx
...
ReactDOM.render(
  <StrictMode>
    <ApiErrorBoundary>
      <TodoProvider todoService={todoService}>
        <SearchProvider searchService={searchService}>
          <App />
        </SearchProvider>
      </TodoProvider>
    </ApiErrorBoundary>
  </StrictMode>,
  document.getElementById('root')
)
...
```

```ts
const useTryCatchErrorHandling = <T extends unknown[]>(
  callback: (...rest: T) => Promise<void>
) => {
  const [_, setState] = useState()

  return async (...args: T) => {
    try {
      await callback(...args)
    } catch (e: any) {
      // ErrorBoundaryë¡œ Promise, event handler ì—ëŸ¬ë¥¼ throw í•˜ê¸°ìœ„í•œ hack
      setState(() => {
        throw e
      })
    }
  }
}
```

```tsx
class ApiErrorBoundary extends React.Component<
  ApiErrorBoundaryProps,
  ApiErroBoundaryState
> {
  constructor(props: ApiErrorBoundaryProps) {
    super(props)
    this.state = { hasError: false }
  }

  static getDerivedStateFromError(error: Error): ApiErroBoundaryState {
    const statusCode = error instanceof HttpError ? error.statusCode : undefined

    return { hasError: true, statusCode }
  }

  componentDidCatch(error: Error, errorInfo: React.ErrorInfo): void {
    console.error(error, errorInfo)
  }

  render() {
    const { hasError, statusCode } = this.state

    if (hasError) {
      switch (statusCode) {
        case 401:
          return <h1>ì¸ì¦ë˜ì§€ ì•Šì€ ì‚¬ìš©ì ì…ë‹ˆë‹¤.</h1>
        case 404:
          return <h1>í˜ì´ì§€ë¥¼ ì°¾ì„ ìˆ˜ ì—†ìŠµë‹ˆë‹¤. </h1>
        case 500:
          return <h1>ì„œë²„ ì˜¤ë¥˜</h1>

        default:
          return <h1>Error!!!!</h1>
      }
    }
    return this.props.children
  }
}
```

<br />

### 9) E2E Test

`cypress` ë¥¼ ì´ìš©í•˜ì—¬ e2e test ë¥¼ ì§„í–‰í•˜ì˜€ë‹¤.
test case ëŠ” 3ê°œì˜ caseë¥¼ ë‘ì—ˆê³ 
1.fixture ì— mock data ë¡œ 'lorem' ì„ ê²€ìƒ‰ì‹œ ì˜ `length` ë¥¼ ë¹„êµ ê²€ì¦
2.'lorem' ê²€ìƒ‰í›„ `scrollTo` í›„ `length` ê°€ ì¶”ê°€ ë˜ì–´ìˆëŠ”ì§€ ê²€ì¦
3.dropdown item ì„ í´ë¦­ì‹œ todo list ì— ì¶”ê°€ë˜ì—ˆëŠ”ì§€ ê²€ì¦

```ts
describe('Search', () => {
  before(() => {
    cy.visit('/')
  })

  it('should display dropdown items length', () => {
    cy.intercept('GET', '**/search**', { fixture: 'searchResult.json' }).as(
      'searchRequest'
    )

    cy.get('[data-cy="search-input"]').type('lorem')

    cy.wait('@searchRequest')

    cy.get('[data-cy="dropdown-item"]').should('have.length', 10)
  })

  it('should load more results on scroll', () => {
    cy.visit('/')

    cy.get('[data-cy="search-input"]').type('lorem')

    cy.get('[data-cy="dropdown-item"]').should('have.length', 10)

    cy.get('[data-cy="search-dropdown"]').scrollTo('bottom')

    cy.get('[data-cy="dropdown-item"]').should('have.length.greaterThan', 9)
  })

  it('should add selected item to todo list', () => {
    cy.visit('/')

    cy.get('[data-cy="search-input"]').type('lorem')

    cy.get('[data-cy="dropdown-item"]').first().click()

    cy.get('[data-cy="todo-item"]')
      .its('length')
      .then(length => {
        cy.log(`Todo list length after adding: ${length}`)

        cy.wrap(length).should('eq', length)
      })
  })
})
```

<br >

# 5. ì„¤ì¹˜ & ì‹¤í–‰ ë°©ë²•

```node
yarn
yarn start

or

npm i --force || --legacy-peer-deps
npm start
```

<br />

# 6. ê¸°ìˆ  ìŠ¤íƒ

<img src="https://img.shields.io/badge/React-61DAFB?style=for-the-badge&logo=React&logoColor=black">
<img src="https://img.shields.io/badge/TypeScript-3178C6?style=for-the-badge&logo=TypeScript&logoColor=black">
<img src="https://img.shields.io/badge/axios-5A29E4?style=for-the-badge&logo=axios&logoColor=black">
<img src="https://img.shields.io/badge/vercel-000000?style=for-the-badge&logo=vercel&logoColor=white">
<img src="https://img.shields.io/badge/eslint-4B32C3?style=for-the-badge&logo=eslint&logoColor=black">
<img src="https://img.shields.io/badge/prettier-F7B93E?style=for-the-badge&logo=prettier&logoColor=black">
<img src="https://img.shields.io/badge/styledcomponents-DB7093?style=for-the-badge&logo=styledcomponents&logoColor=black">
<img src="https://img.shields.io/badge/husky-E0E0E0?style=for-the-badge&logo=husky&logoColor=black">
